{
  "Serilog": {
    "Using": [
      "Serilog.Sinks.Console",
      "Serilog.Sinks.File",
      "Serilog.Enrichers.Environment",
      "Serilog.Enrichers.Thread",
      "Serilog.Expressions"
    ],
    "MinimumLevel": {
      "Default": "Information",
      "Override": {
        "Microsoft": "Warning",
        "Microsoft.AspNetCore": "Warning",
        "Microsoft.EntityFrameworkCore": "Warning",
        "System": "Warning",
        "Yarp": "Information"
      }
    },
    "WriteTo": [
      {
        "Name": "Console",
        "Args": {
          "theme": "Serilog.Sinks.SystemConsole.Themes.AnsiConsoleTheme::Code, Serilog.Sinks.Console"
        }
      },
      {
        "Name": "File",
        "Args": {
          "path": "logs/llmproxy-.json",
          "rollingInterval": "Day",
          "retainedFileCountLimit": 30,
          "formatter": "Serilog.Formatting.Compact.CompactJsonFormatter, Serilog.Formatting.Compact"
        }
      },
      {
        "Name": "File",
        "Args": {
          "path": "logs/llmproxy-errors-.json",
          "rollingInterval": "Day",
          "retainedFileCountLimit": 90,
          "restrictedToMinimumLevel": "Error",
          "formatter": "Serilog.Formatting.Compact.CompactJsonFormatter, Serilog.Formatting.Compact"
        }
      }
    ],
    "Enrich": [
      "FromLogContext",
      "WithMachineName",
      "WithThreadId"
    ],
    "Properties": {
      "Application": "LLMProxy.Gateway"
    },
    "LogsPath": "logs"
  },
  "AllowedHosts": "*",
  
  "ConnectionStrings": {
    "PostgreSQL": "Host=localhost;Port=5432;Database=llmproxy;Username=postgres;Password=postgres",
    "Redis": "localhost:6379"
  },
  
  "Authentication": {
    "Authority": "https://your-auth-server.com",
    "Audience": "llmproxy-api"
  },
  
  "OpenTelemetry": {
    "ServiceName": "LLMProxy.Gateway",
    "ServiceVersion": "2.0.0",
    "Tracing": {
      "Sampler": "ParentBased",
      "SamplingRatio": 0.1,
      "AlwaysSampleErrors": true
    },
    "Metrics": {
      "ExportIntervalMilliseconds": 15000,
      "HistogramBuckets": [0.01, 0.05, 0.1, 0.5, 1, 2, 5, 10, 30, 60]
    },
    "Exporter": {
      "Type": "OTLP",
      "Endpoint": "http://localhost:4317",
      "Protocol": "grpc"
    }
  },

  "StreamInterception": {
    "MaxStreamSizeBytes": 10485760
  },

  "CircuitBreaker": {
    "FailureThreshold": 0.5,
    "DurationOfBreak": "00:00:30",
    "MinimumThroughput": 10,
    "SamplingDuration": "00:01:00",
    "PermittedNumberOfCallsInHalfOpenState": 3
  },

  "RetryPolicy": {
    "MaxRetryAttempts": 3,
    "InitialDelay": "00:00:01",
    "UseJitter": true,
    "BackoffType": "Exponential"
  },

  "RateLimiting": {
    "Global": {
      "PermitLimit": 10000,
      "Window": "00:01:00"
    },
    "PerTenant": {
      "PermitLimit": 1000,
      "Window": "01:00:00"
    },
    "PerUser": {
      "PermitLimit": 100,
      "Window": "00:01:00",
      "SegmentsPerWindow": 6
    },
    "PerIp": {
      "PermitLimit": 50,
      "Window": "00:01:00"
    },
    "Concurrency": {
      "PermitLimit": 500,
      "QueueLimit": 0
    }
  },
  
  "ReverseProxy": {
    "Routes": {
      "openai-route": {
        "ClusterId": "openai-cluster",
        "Match": {
          "Path": "/openai/{**catch-all}"
        },
        "Transforms": [
          {
            "PathRemovePrefix": "/openai"
          }
        ]
      },
      "ollama-route": {
        "ClusterId": "ollama-cluster",
        "Match": {
          "Path": "/ollama/{**catch-all}"
        },
        "Transforms": [
          {
            "PathRemovePrefix": "/ollama"
          }
        ]
      },
      "anthropic-route": {
        "ClusterId": "anthropic-cluster",
        "Match": {
          "Path": "/anthropic/{**catch-all}"
        },
        "Transforms": [
          {
            "PathRemovePrefix": "/anthropic"
          }
        ]
      }
    },
    "Clusters": {
      "openai-cluster": {
        "Destinations": {
          "destination1": {
            "Address": "https://api.openai.com"
          }
        },
        "HttpClient": {
          "DangerousAcceptAnyServerCertificate": false
        },
        "HealthCheck": {
          "Active": {
            "Enabled": true,
            "Interval": "00:00:30",
            "Timeout": "00:00:10",
            "Policy": "ConsecutiveFailures",
            "Path": "/"
          }
        }
      },
      "ollama-cluster": {
        "Destinations": {
          "destination1": {
            "Address": "http://localhost:11434"
          }
        }
      },
      "anthropic-cluster": {
        "Destinations": {
          "destination1": {
            "Address": "https://api.anthropic.com"
          }
        }
      }
    }
  },

  "FeatureFlags": {
    "llm_use_optimized_provider": false,
    "llm_enable_streaming": true,
    "llm_use_new_token_counter": false,
    "quota_enhanced_tracking": false,
    "quota_realtime_alerts": false,
    "api_enable_rate_limiting_v2": false,
    "api_new_authentication_flow": false,
    "ui_new_dashboard": false,
    "ui_dark_mode": true,
    "experimental_ai_caching": false,
    "experimental_prompt_compression": false
  }
}
